{"version":3,"file":"index.js","sources":["../src/utils.js","../src/index.js"],"sourcesContent":["import { isTemplate } from '@tiny-lit/core/dist/esm/utils';\n\nexport function getType(obj) {\n    return obj === null ? 'null' : Array.isArray(obj) ? 'array' : typeof obj;\n}\n\nexport function isPrimitive(obj) {\n    return obj !== Object(obj);\n}\n\nexport function isNode(obj) {\n    return !!obj && (!!obj.nodeType || isTemplate(obj));\n}\n\nexport function JsonObject(obj) {\n    try {\n        if (typeof obj === 'string') return JSON.parse(obj);\n    } catch (ex) {\n        console.error(ex);\n    }\n    return obj;\n}\n\nexport function classNames(...classes) {\n    return classes.filter(Boolean).join(' ');\n}\n\nexport function generateNodePreview(node, options) {\n    const { nodeCount, maxLength } = {\n        nodeCount: 3,\n        maxLength: 15,\n        ...options\n    };\n    const isArray = Array.isArray(node);\n    const objectNodes = Object.keys(node);\n    const keys = objectNodes.slice(0, nodeCount);\n    const preview = [isArray ? '[ ' : '{ '];\n\n    preview.push(\n        keys\n            .reduce((allNodesPreview, key) => {\n                const nodePreview = [];\n                const nodeValue = node[key];\n                const nodeType = getType(nodeValue);\n\n                if (!isArray) nodePreview.push(`${key}: `);\n\n                if (nodeType === 'object') nodePreview.push('{ ... }');\n                else if (nodeType === 'array') nodePreview.push('[ ... ]');\n                else if (nodeType === 'string')\n                    nodePreview.push(\n                        `\"${nodeValue.substring(0, maxLength)}${nodeValue.length > maxLength ? '...' : ''}\"`\n                    );\n                else nodePreview.push(String(nodeValue));\n\n                return allNodesPreview.concat(nodePreview.join(''));\n            }, [])\n            .join(', ')\n    );\n\n    if (objectNodes.length > nodeCount) preview.push(', ...');\n\n    preview.push(isArray ? ' ]' : ' }');\n\n    return preview.join('');\n}\n","import { Element as TinyElement } from '@tiny-lit/element';\nimport { html } from '@tiny-lit/core';\nimport { getType, isPrimitive, JsonObject, generateNodePreview, isNode, classNames } from './utils';\n\nconst ObjectKey = ({ isCollapsable, collapsed, onClick, key }) => html`\n    <span\n        class=${classNames(key && 'key', isCollapsable && 'collapsable', collapsed && 'collapsableCollapsed')}\n        onClick=${onClick}\n    >\n        ${key}:\n    </span>\n`;\n\nclass JsonNestedObjectNode extends TinyElement {\n    data = null;\n    collapsed = true;\n\n    static get properties() {\n        return {\n            data: JsonObject,\n            collapsed: Boolean,\n            key: String\n        };\n    }\n\n    static get is() {\n        return 'json-nested-object-node';\n    }\n\n    handleKeyClick = e => {\n        e.preventDefault();\n        this.collapsed = !this.collapsed;\n    };\n\n    renderValue(node) {\n        return isNode(node)\n            ? node\n            : html`\n                  <span class=${getType(node)}>${JSON.stringify(node)}</span>\n              `;\n    }\n\n    renderChild(node) {\n        return this.collapsed\n            ? html`\n                  <span class=\"preview\">\n                      ${generateNodePreview(node)}\n                  </span>\n              `\n            : html`\n                  <json-object-node data=${node}></json-object-node>\n              `;\n    }\n\n    render() {\n        const { data, key } = this;\n        const isPrimitiveOrNode = isPrimitive(data) || isNode(data);\n\n        return html`\n            ${ObjectKey({\n                isCollapsable: !isPrimitiveOrNode,\n                collapsed: this.collapsed,\n                key,\n                onClick: !isPrimitiveOrNode && this.handleKeyClick\n            })}\n            ${isPrimitiveOrNode ? this.renderValue(data) : this.renderChild(data)}\n        `;\n    }\n}\n\nclass JsonObjectNode extends TinyElement {\n    data = null;\n    collapsed = true;\n\n    static get is() {\n        return 'json-object-node';\n    }\n\n    static get properties() {\n        return {\n            data: JsonObject,\n            collapsed: Boolean\n        };\n    }\n\n    render() {\n        const { data } = this;\n\n        return html`\n            <ul>\n                ${Object.keys(data).map(key =>\n                    html`\n                        <li>\n                            <json-nested-object-node key=${key} data=${data[key]}></json-nested-object-node>\n                        </li>\n                    `.withKey(key)\n                )}\n            </ul>\n        `;\n    }\n}\n\nclass JsonViewer extends TinyElement {\n    data = null;\n\n    static get is() {\n        return 'json-viewer';\n    }\n\n    static get properties() {\n        return {\n            data: JsonObject\n        };\n    }\n\n    connectedCallback() {\n        const json = this.innerText.trim();\n        if (json) this.data = JSON.parse(json);\n\n        this.attachShadow({ mode: 'open' });\n\n        super.connectedCallback();\n    }\n\n    render() {\n        return html`\n            <style>\n                :host {\n                    --background-color: rgb(42, 47, 58);\n                    --color: #f8f8f2;\n                    --string-color: #a3eea0;\n                    --number-color: #d19a66;\n                    --boolean-color: #4ba7ef;\n                    --null-color: #df9cf3;\n                    --key-color: rgb(111, 179, 210);\n                    --collapsed-color: #fff;\n                    --collapsed-background: #66d9ef;\n                    --font-family: monaco, Consolas, 'Lucida Console', monospace;\n                    --preview-color: rgba(222, 175, 143, 0.9);\n\n                    display: block;\n                    background-color: var(--background-color);\n                    color: var(--color);\n                    padding: 0.5rem;\n                    font-family: var(--font-family);\n                    font-size: 1rem;\n                }\n\n                .preview {\n                    color: var(--preview-color);\n                }\n\n                .collapsed ul {\n                    display: none;\n                }\n\n                .null {\n                    color: var(--null-color, #df9cf3);\n                }\n\n                .key {\n                    color: var(--key-color, #f9857b);\n                    display: inline-block;\n                }\n\n                .collapsable:before {\n                    display: inline-block;\n                    color: var(--color);\n                    padding-right: 5px;\n                    padding-left: 5px;\n                    font-size: 0.7rem;\n                    content: 'â–¶';\n                    transition: transform 195ms ease-in;\n                    transform: rotate(90deg);\n                    color: var(--key-color);\n                }\n\n                .collapsable.collapsableCollapsed:before {\n                    transform: rotate(0);\n                }\n\n                .collapsable {\n                    cursor: pointer;\n                    user-select: none;\n                }\n\n                .string {\n                    color: var(--string-color);\n                }\n\n                .number {\n                    color: var(--number-color);\n                }\n\n                .boolean {\n                    color: var(--boolean-color);\n                }\n\n                .collapsed {\n                    font-size: 10px;\n                    background-color: var(--collapsed-background);\n                    color: var(--collapsed-color);\n                    padding: 0.3em;\n                    border-radius: 2px;\n                }\n\n                ul {\n                    padding: 0;\n                    clear: both;\n                }\n\n                ul,\n                li {\n                    list-style: none;\n                    position: relative;\n                }\n\n                li ul > li {\n                    position: relative;\n                    padding-top: 0.25rem;\n                    margin-left: 1.5rem;\n                    padding-left: 0px;\n                }\n\n                ul:before {\n                    content: '';\n                    border-left: 1px solid #333;\n                    position: absolute;\n                    left: 0.5rem;\n                    top: 0.5rem;\n                    bottom: 0.5rem;\n                }\n\n                ul.hover:before {\n                    border-left: 1px solid #666;\n                }\n            </style>\n            <json-object-node data=${this.data}></json-object-node>\n        `;\n    }\n}\ncustomElements.define(JsonObjectNode.is, JsonObjectNode);\ncustomElements.define(JsonNestedObjectNode.is, JsonNestedObjectNode);\ncustomElements.define(JsonViewer.is, JsonViewer);\n"],"names":["getType","obj","Array","isArray","isPrimitive","Object","isNode","nodeType","isTemplate","JsonObject","JSON","parse","ex","console","error","classNames","classes","filter","Boolean","join","generateNodePreview","node","options","nodeCount","maxLength","objectNodes","keys","slice","preview","push","reduce","allNodesPreview","key","nodePreview","nodeValue","substring","length","String","concat","ObjectKey","isCollapsable","collapsed","onClick","html","JsonNestedObjectNode","TinyElement","data","handleKeyClick","e","preventDefault","properties","is","renderValue","stringify","renderChild","render","isPrimitiveOrNode","JsonObjectNode","map","withKey","JsonViewer","connectedCallback","json","innerText","trim","attachShadow","mode","customElements","define"],"mappings":"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"}
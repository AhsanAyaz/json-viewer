{"version":3,"file":"index.js","sources":["../src/utils.js","../src/index.js"],"sourcesContent":["export function getType(obj) {\n    return obj === null ? 'null' : Array.isArray(obj) ? 'array' : typeof obj;\n}\n\nexport function isPrimitive(obj) {\n    return obj !== Object(obj);\n}\n\nexport function JsonObject(obj) {\n    try {\n        if (typeof obj === 'string') return JSON.parse(obj);\n    } catch (ex) {\n        console.error(ex);\n    }\n    return obj;\n}\n\nexport function generateNodePreview(node, options) {\n    const { nodeCount, maxLength } = {\n        nodeCount: 3,\n        maxLength: 15,\n        ...options\n    };\n    const isArray = Array.isArray(node);\n    const objectNodes = Object.keys(node);\n    const keys = objectNodes.slice(0, nodeCount);\n    const preview = [isArray ? '[ ' : '{ '];\n\n    preview.push(\n        keys\n            .reduce((allNodesPreview, key) => {\n                const nodePreview = [];\n                const nodeValue = node[key];\n                const nodeType = getType(nodeValue);\n\n                if (!isArray) nodePreview.push(`${key}: `);\n\n                if (nodeType === 'object') nodePreview.push('{ ... }');\n                else if (nodeType === 'array') nodePreview.push('[ ... ]');\n                else if (nodeType === 'string')\n                    nodePreview.push(\n                        `\"${nodeValue.substring(0, maxLength)}${nodeValue.length > maxLength ? '...' : ''}\"`\n                    );\n                else nodePreview.push(String(nodeValue));\n\n                return allNodesPreview.concat(nodePreview.join(''));\n            }, [])\n            .join(', ')\n    );\n\n    if (objectNodes.length > nodeCount) preview.push(', ...');\n\n    preview.push(isArray ? ' ]' : ' }');\n\n    return preview.join('');\n}\n","import { Element as TinyElement } from '@tiny-lit/element';\nimport { html } from '@tiny-lit/core';\nimport cn from 'classnames';\nimport { getType, isPrimitive, JsonObject, generateNodePreview } from './utils';\n\nconst ObjectKey = ({ isCollapsable, collapsed, onClick, key }) => html`\n    <span\n        class=${cn([\n            {\n                key: key,\n                collapsable: isCollapsable,\n                collapsableCollapsed: collapsed\n            }\n        ])}\n        onClick=${onClick}\n    >\n        ${key}:\n    </span>\n`;\n\nclass JsonNestedObjectNode extends TinyElement {\n    data = null;\n    collapsed = true;\n\n    static get properties() {\n        return {\n            data: JsonObject,\n            collapsed: Boolean,\n            key: String\n        };\n    }\n\n    static get is() {\n        return 'json-nested-object-node';\n    }\n\n    handleKeyClick = e => {\n        e.preventDefault();\n        this.collapsed = !this.collapsed;\n    };\n\n    renderValue(node) {\n        const type = getType(node);\n\n        return html`\n            <span class=${type}>${JSON.stringify(node)}</span>\n        `;\n    }\n\n    renderChild(node) {\n        return this.collapsed\n            ? html`\n                  <span class=\"preview\">\n                      ${generateNodePreview(node)}\n                  </span>\n              `\n            : html`\n                  <json-object-node data=${node}></json-object-node>\n              `;\n    }\n\n    render() {\n        const { data, key } = this;\n\n        return html`\n            ${ObjectKey({\n                isCollapsable: !isPrimitive(data),\n                collapsed: this.collapsed,\n                key,\n                onClick: !isPrimitive(data) && this.handleKeyClick\n            })}\n            ${isPrimitive(data) ? this.renderValue(data) : this.renderChild(data)}\n        `;\n    }\n}\n\nclass JsonObjectNode extends TinyElement {\n    data = null;\n    collapsed = true;\n\n    static get is() {\n        return 'json-object-node';\n    }\n\n    static get properties() {\n        return {\n            data: JsonObject,\n            collapsed: Boolean\n        };\n    }\n\n    render() {\n        const { data } = this;\n\n        return html`\n            <ul>\n                ${Object.keys(data).map(key =>\n                    html`\n                        <li>\n                            <json-nested-object-node key=${key} data=${data[key]}></json-nested-object-node>\n                        </li>\n                    `.withKey(key)\n                )}\n            </ul>\n        `;\n    }\n}\n\nclass JsonViewer extends TinyElement {\n    json = null;\n    data = '';\n\n    static get is() {\n        return 'json-viewer';\n    }\n\n    static get properties() {\n        return {\n            data: JsonObject\n        };\n    }\n\n    connectedCallback() {\n        const data = JSON.parse(this.innerText);\n\n        this.attachShadow({ mode: 'open' });\n        this.data = data;\n\n        super.connectedCallback();\n    }\n\n    render() {\n        return html`\n            <style>\n                :host {\n                    --background-color: rgb(42, 47, 58);\n                    --color: #f8f8f2;\n                    --string-color: #a3eea0;\n                    --number-color: #d19a66;\n                    --boolean-color: #4ba7ef;\n                    --null-color: #df9cf3;\n                    --key-color: rgb(111, 179, 210);\n                    --collapsed-color: #fff;\n                    --collapsed-background: #66d9ef;\n                    --font-family: monaco, Consolas, 'Lucida Console', monospace;\n                    --preview-color: rgba(222, 175, 143, 0.9);\n\n                    display: block;\n                    background-color: var(--background-color);\n                    color: var(--color);\n                    padding: 0.5rem;\n                    font-family: var(--font-family);\n                    font-size: 1rem;\n                }\n\n                .preview {\n                    color: var(--preview-color);\n                }\n\n                .collapsed ul {\n                    display: none;\n                }\n\n                .null {\n                    color: var(--null-color, #df9cf3);\n                }\n\n                .key {\n                    color: var(--key-color, #f9857b);\n                    display: inline-block;\n                }\n\n                .collapsable:before {\n                    display: inline-block;\n                    color: var(--color);\n                    padding-right: 5px;\n                    padding-left: 5px;\n                    font-size: 0.7rem;\n                    content: 'â–¶';\n                    transition: transform 195ms ease-in;\n                    transform: rotate(90deg);\n                    color: var(--key-color);\n                }\n\n                .collapsable.collapsableCollapsed:before {\n                    transform: rotate(0);\n                }\n\n                .collapsable {\n                    cursor: pointer;\n                    user-select: none;\n                }\n\n                .string {\n                    color: var(--string-color);\n                }\n\n                .number {\n                    color: var(--number-color);\n                }\n\n                .boolean {\n                    color: var(--boolean-color);\n                }\n\n                .collapsed {\n                    font-size: 10px;\n                    background-color: var(--collapsed-background);\n                    color: var(--collapsed-color);\n                    padding: 0.3em;\n                    border-radius: 2px;\n                }\n\n                ul {\n                    padding: 0;\n                    clear: both;\n                }\n\n                ul,\n                li {\n                    list-style: none;\n                    position: relative;\n                }\n\n                li ul > li {\n                    position: relative;\n                    padding-top: 0.25rem;\n                    margin-left: 1.5rem;\n                    padding-left: 0px;\n                    white-space: nowrap;\n                }\n\n                ul:before {\n                    content: '';\n                    border-left: 1px solid #333;\n                    position: absolute;\n                    left: 0.5rem;\n                    top: 0.5rem;\n                    bottom: 0.5rem;\n                }\n\n                ul.hover:before {\n                    border-left: 1px solid #666;\n                }\n            </style>\n            <json-object-node data=${this.data}></json-object-node>\n        `;\n    }\n}\ncustomElements.define(JsonObjectNode.is, JsonObjectNode);\ncustomElements.define(JsonNestedObjectNode.is, JsonNestedObjectNode);\ncustomElements.define(JsonViewer.is, JsonViewer);\n"],"names":["getType","obj","Array","isArray","isPrimitive","Object","JsonObject","JSON","parse","ex","console","error","generateNodePreview","node","options","nodeCount","maxLength","objectNodes","keys","slice","preview","push","reduce","allNodesPreview","key","nodePreview","nodeValue","nodeType","substring","length","String","concat","join","ObjectKey","isCollapsable","collapsed","onClick","html","cn","collapsable","collapsableCollapsed","JsonNestedObjectNode","TinyElement","data","handleKeyClick","e","preventDefault","properties","Boolean","is","renderValue","type","stringify","renderChild","render","JsonObjectNode","map","withKey","JsonViewer","json","connectedCallback","innerText","attachShadow","mode","customElements","define"],"mappings":"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"}